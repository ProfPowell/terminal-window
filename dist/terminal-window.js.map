{"version":3,"file":"terminal-window.js","sources":["../src/internals/ansi-parser.js","../src/internals/command-registry.js","../src/internals/history-manager.js","../src/internals/file-system.js","../src/styles.js","../src/terminal-window.js"],"sourcesContent":["/**\n * ANSI Escape Code Parser\n * Handles parsing of ANSI color codes and styles into HTML\n */\nexport class AnsiParser {\n  constructor() {\n    // ANSI color code mappings\n    this.ansiColors = {\n      '30': 'ansi-black',\n      '31': 'ansi-red',\n      '32': 'ansi-green',\n      '33': 'ansi-yellow',\n      '34': 'ansi-blue',\n      '35': 'ansi-magenta',\n      '36': 'ansi-cyan',\n      '37': 'ansi-white',\n      '90': 'ansi-bright-black',\n      '91': 'ansi-bright-red',\n      '92': 'ansi-bright-green',\n      '93': 'ansi-bright-yellow',\n      '94': 'ansi-bright-blue',\n      '95': 'ansi-bright-magenta',\n      '96': 'ansi-bright-cyan',\n      '97': 'ansi-bright-white',\n    };\n\n    this.ansiBgColors = {\n      '40': 'ansi-bg-black',\n      '41': 'ansi-bg-red',\n      '42': 'ansi-bg-green',\n      '43': 'ansi-bg-yellow',\n      '44': 'ansi-bg-blue',\n      '45': 'ansi-bg-magenta',\n      '46': 'ansi-bg-cyan',\n      '47': 'ansi-bg-white',\n    };\n  }\n\n  /**\n   * Parse ANSI escape codes and convert to HTML\n   * @param {string} text - Text with ANSI codes\n   * @param {Function} escapeHtml - Function to escape HTML\n   * @returns {string} HTML string\n   */\n  parse(text, escapeHtml) {\n    // Match ANSI escape sequences\n    const ansiRegex = /\\x1b\\[([0-9;]+)m/g;\n    let result = '';\n    let lastIndex = 0;\n    let currentClasses = [];\n    let match;\n\n    while ((match = ansiRegex.exec(text)) !== null) {\n      // Add text before this match\n      if (match.index > lastIndex) {\n        const textBefore = escapeHtml(text.slice(lastIndex, match.index));\n        if (currentClasses.length > 0) {\n          result += `<span class=\"${currentClasses.join(' ')}\">${textBefore}</span>`;\n        } else {\n          result += textBefore;\n        }\n      }\n\n      // Parse the codes\n      const codes = match[1].split(';');\n      for (const code of codes) {\n        if (code === '0') {\n          // Reset\n          currentClasses = [];\n        } else if (code === '1') {\n          currentClasses.push('ansi-bold');\n        } else if (code === '3') {\n          currentClasses.push('ansi-italic');\n        } else if (code === '4') {\n          currentClasses.push('ansi-underline');\n        } else if (this.ansiColors[code]) {\n          // Remove any existing color class\n          currentClasses = currentClasses.filter(c => !c.startsWith('ansi-') || c.startsWith('ansi-bg-') || c.startsWith('ansi-bold') || c.startsWith('ansi-italic') || c.startsWith('ansi-underline'));\n          currentClasses.push(this.ansiColors[code]);\n        } else if (this.ansiBgColors[code]) {\n          currentClasses = currentClasses.filter(c => !c.startsWith('ansi-bg-'));\n          currentClasses.push(this.ansiBgColors[code]);\n        }\n      }\n\n      lastIndex = match.index + match[0].length;\n    }\n\n    // Add remaining text\n    if (lastIndex < text.length) {\n      const remaining = escapeHtml(text.slice(lastIndex));\n      if (currentClasses.length > 0) {\n        result += `<span class=\"${currentClasses.join(' ')}\">${remaining}</span>`;\n      } else {\n        result += remaining;\n      }\n    }\n\n    return result || escapeHtml(text);\n  }\n}\n","/**\n * Command Registry\n * Handles command registration, aliasing, and execution lookup\n */\nexport class CommandRegistry {\n  constructor() {\n    // Command registry - users can register functions that return strings\n    this.commands = new Map();\n\n    // Command aliases\n    this.aliases = new Map();\n  }\n\n  /**\n   * Register a command handler\n   * @param {string} name - Command name\n   * @param {Function} handler - Function that receives args array and returns string or null\n   */\n  register(name, handler) {\n    this.commands.set(name.toLowerCase(), handler);\n  }\n\n  /**\n   * Unregister a command\n   * @param {string} name - Command name\n   */\n  unregister(name) {\n    this.commands.delete(name.toLowerCase());\n  }\n\n  /**\n   * Register a command alias\n   * @param {string} alias - Alias name\n   * @param {string} command - Command to execute\n   */\n  registerAlias(alias, command) {\n    this.aliases.set(alias.toLowerCase(), command);\n  }\n\n  /**\n   * Check if command exists\n   * @param {string} name - Command name\n   * @returns {boolean}\n   */\n  has(name) {\n    return this.commands.has(name.toLowerCase());\n  }\n\n  /**\n   * Get a command handler\n   * @param {string} name - Command name\n   * @returns {Function|undefined}\n   */\n  get(name) {\n    return this.commands.get(name.toLowerCase());\n  }\n\n  /**\n   * Get all command names\n   * @returns {string[]}\n   */\n  getNames() {\n    return Array.from(this.commands.keys()).sort();\n  }\n\n  /**\n   * Resolve a potential alias\n   * @param {string} input - Input string\n   * @returns {string} Resolved command string\n   */\n  resolveAlias(input) {\n    const firstWord = input.split(' ')[0].toLowerCase();\n    if (this.aliases.has(firstWord)) {\n      return this.aliases.get(firstWord) + input.slice(firstWord.length);\n    }\n    return input;\n  }\n\n  /**\n   * Parse command string into parts (handles quotes)\n   * @param {string} input - Command input\n   * @returns {string[]} Array of command parts\n   */\n  parse(input) {\n    const parts = [];\n    let current = '';\n    let inQuote = false;\n    let quoteChar = '';\n\n    for (let i = 0; i < input.length; i++) {\n      const char = input[i];\n\n      if (!inQuote && (char === '\"' || char === \"'\")) {\n        inQuote = true;\n        quoteChar = char;\n      } else if (inQuote && char === quoteChar) {\n        inQuote = false;\n        quoteChar = '';\n      } else if (!inQuote && char === ' ') {\n        if (current) {\n          parts.push(current);\n          current = '';\n        }\n      } else {\n        current += char;\n      }\n    }\n\n    if (current) {\n      parts.push(current);\n    }\n\n    return parts;\n  }\n}\n","/**\n * History Manager\n * Handles storage and navigation of command history\n */\nexport class HistoryManager {\n  constructor() {\n    this.history = [];\n    this.index = -1;\n    this.storageKey = 'terminal-history';\n  }\n\n  /**\n   * Add a command to history\n   * @param {string} command - Command to add\n   */\n  add(command) {\n    // Don't add empty or duplicate of last command\n    if (!command || (this.history.length > 0 && this.history[this.history.length - 1] === command)) {\n        this.index = this.history.length;\n        return;\n    }\n    this.history.push(command);\n    this.index = this.history.length;\n    this._persist();\n  }\n\n  /**\n   * Navigate history\n   * @param {number} direction - Direction (-1 for up/back, 1 for down/forward)\n   * @returns {string|null} The command at the new index, or null if out of bounds (or empty string if new line)\n   */\n  navigate(direction) {\n    const newIndex = this.index + direction;\n\n    if (newIndex < 0) return null;\n    \n    if (newIndex >= this.history.length) {\n      this.index = this.history.length;\n      return '';\n    }\n    \n    this.index = newIndex;\n    return this.history[this.index];\n  }\n\n  /**\n   * Get the current history array (copy)\n   * @returns {string[]}\n   */\n  getHistory() {\n    return [...this.history];\n  }\n\n  /**\n   * Set the history array\n   * @param {string[]} history \n   */\n  setHistory(history) {\n    if (Array.isArray(history)) {\n      this.history = history.map(cmd => String(cmd));\n      this.index = this.history.length;\n      this._persist();\n    }\n  }\n\n  /**\n   * Clear history\n   */\n  clear() {\n    this.history = [];\n    this.index = -1;\n    this._persist();\n  }\n\n  /**\n   * Get formatted history for display\n   * @returns {string} Formatted history string\n   */\n  getFormattedHistory() {\n    return this.history.map((cmd, i) => `  ${i + 1}  ${cmd}`).join('\\n');\n  }\n\n  /**\n   * Check if history is empty\n   * @returns {boolean}\n   */\n  isEmpty() {\n    return this.history.length === 0;\n  }\n\n  /**\n   * Enable/Disable persistence\n   * @param {boolean} enabled \n   */\n  setPersistence(enabled) {\n      this.persistenceEnabled = enabled;\n      if (enabled) {\n          this._load();\n      } else {\n          localStorage.removeItem(this.storageKey);\n      }\n  }\n\n  _persist() {\n      if (this.persistenceEnabled) {\n          try {\n              localStorage.setItem(this.storageKey, JSON.stringify(this.history));\n          } catch (e) {\n              console.warn('Failed to save history to localStorage', e);\n          }\n      }\n  }\n\n  _load() {\n      try {\n          const saved = localStorage.getItem(this.storageKey);\n          if (saved) {\n              this.history = JSON.parse(saved);\n              this.index = this.history.length;\n          }\n      } catch (e) {\n          console.warn('Failed to load history from localStorage', e);\n      }\n  }\n}\n","/**\n * Virtual File System (VFS)\n * A simple in-memory file system structure and operations\n */\nexport class VirtualFileSystem {\n  constructor() {\n    // Root directory structure\n    this.root = {\n      type: 'dir',\n      name: '/',\n      children: new Map(),\n      parent: null\n    };\n    \n    // Current working directory (pointer to a directory object)\n    this.cwd = this.root;\n    \n    // Current path string (for display/quick access)\n    this.currentPath = '/';\n    \n    // Initialize default structure\n    this._initDefaultStructure();\n  }\n\n  /**\n   * Initialize default file system structure\n   */\n  _initDefaultStructure() {\n    this.mkdir('/home');\n    this.mkdir('/home/user');\n    this.mkdir('/bin');\n    this.mkdir('/etc');\n    this.mkdir('/tmp');\n    this.mkdir('/var');\n    \n    // Set default user directory\n    this.cwd = this.resolvePathObject('/home/user');\n    this.currentPath = '/home/user';\n    \n    // Add some default files\n    this.writeFile('/home/user/README.md', '# Welcome\\n\\nThis is a virtual file system.');\n  }\n\n  /**\n   * Get current working directory path\n   * @returns {string}\n   */\n  getcwd() {\n    return this.currentPath;\n  }\n\n  /**\n   * Change directory\n   * @param {string} path \n   * @returns {string|null} Error message or null if success\n   */\n  cd(path) {\n    if (!path || path === '~') {\n      return this.cd('/home/user');\n    }\n    \n    const target = this.resolvePathObject(path);\n    \n    if (!target) {\n      return `cd: ${path}: No such file or directory`;\n    }\n    \n    if (target.type !== 'dir') {\n      return `cd: ${path}: Not a directory`;\n    }\n    \n    this.cwd = target;\n    this.currentPath = this._getAbsolutePath(target);\n    return null;\n  }\n\n  /**\n   * List directory contents\n   * @param {string} path (optional)\n   * @returns {Array} List of file objects or error string\n   */\n  ls(path = '.') {\n    const target = this.resolvePathObject(path);\n    \n    if (!target) {\n      return `ls: cannot access '${path}': No such file or directory`;\n    }\n    \n    if (target.type !== 'dir') {\n      return [target]; // List the file itself\n    }\n    \n    return Array.from(target.children.values());\n  }\n\n  /**\n   * Create a directory\n   * @param {string} path \n   * @returns {string|null} Error message or null if success\n   */\n  mkdir(path) {\n    const parentPath = path.substring(0, path.lastIndexOf('/')) || (path.startsWith('/') ? '/' : '.');\n    const dirName = path.split('/').pop();\n    \n    const parent = this.resolvePathObject(parentPath);\n    if (!parent) {\n      return `mkdir: cannot create directory '${path}': No such file or directory`;\n    }\n    \n    if (parent.type !== 'dir') {\n      return `mkdir: cannot create directory '${path}': Not a directory`;\n    }\n    \n    if (parent.children.has(dirName)) {\n      return `mkdir: cannot create directory '${path}': File exists`;\n    }\n    \n    const newDir = {\n      type: 'dir',\n      name: dirName,\n      children: new Map(),\n      parent: parent\n    };\n    \n    parent.children.set(dirName, newDir);\n    return null;\n  }\n\n  /**\n   * Create an empty file or update timestamp\n   * @param {string} path \n   */\n  touch(path) {\n    const parentPath = path.substring(0, path.lastIndexOf('/')) || (path.startsWith('/') ? '/' : '.');\n    const fileName = path.split('/').pop();\n    \n    const parent = this.resolvePathObject(parentPath);\n    if (!parent || parent.type !== 'dir') return `touch: cannot touch '${path}': No such file or directory`;\n    \n    if (!parent.children.has(fileName)) {\n      this.writeFile(path, '');\n    }\n    return null;\n  }\n\n  /**\n   * Write content to a file\n   * @param {string} path \n   * @param {string} content \n   */\n  writeFile(path, content) {\n    const parentPath = path.substring(0, path.lastIndexOf('/')) || (path.startsWith('/') ? '/' : '.');\n    const fileName = path.split('/').pop();\n    \n    const parent = this.resolvePathObject(parentPath);\n    if (!parent || parent.type !== 'dir') return false;\n    \n    const file = {\n      type: 'file',\n      name: fileName,\n      content: content,\n      parent: parent,\n      size: content.length,\n      lastModified: new Date()\n    };\n    \n    parent.children.set(fileName, file);\n    return true;\n  }\n\n  /**\n   * Read file content\n   * @param {string} path \n   * @returns {string} Content or error message\n   */\n  readFile(path) {\n    const target = this.resolvePathObject(path);\n    if (!target) return `cat: ${path}: No such file or directory`;\n    if (target.type === 'dir') return `cat: ${path}: Is a directory`;\n    return target.content;\n  }\n\n  /**\n   * Remove a file or directory\n   * @param {string} path \n   * @param {boolean} recursive \n   */\n  rm(path, recursive = false) {\n    const target = this.resolvePathObject(path);\n    if (!target) return `rm: cannot remove '${path}': No such file or directory`;\n    \n    if (target.type === 'dir' && !recursive) {\n      return `rm: cannot remove '${path}': Is a directory`;\n    }\n    \n    // Cannot remove root\n    if (target === this.root) {\n      return `rm: it is dangerous to operate recursively on /`;\n    }\n\n    const parent = target.parent;\n    if (parent) {\n      parent.children.delete(target.name);\n    }\n    return null;\n  }\n\n  /**\n   * Helper: Resolve path string to object\n   */\n  resolvePathObject(path) {\n    if (!path || path === '.') return this.cwd;\n    if (path === '..') return this.cwd.parent || this.root;\n    if (path === '/') return this.root;\n    if (path === '~') return this.resolvePathObject('/home/user');\n    \n    // Handle absolute vs relative paths\n    let current = path.startsWith('/') ? this.root : this.cwd;\n    const parts = path.split('/').filter(p => p && p !== '.');\n    \n    for (const part of parts) {\n      if (part === '..') {\n        current = current.parent || this.root;\n      } else if (current.type === 'dir' && current.children.has(part)) {\n        current = current.children.get(part);\n      } else {\n        return null;\n      }\n    }\n    \n    return current;\n  }\n\n  /**\n   * Helper: Get absolute path string from object\n   */\n  _getAbsolutePath(node) {\n    if (node === this.root) return '/';\n    \n    const parts = [];\n    let current = node;\n    while (current !== this.root) {\n      parts.unshift(current.name);\n      current = current.parent;\n    }\n    return '/' + parts.join('/');\n  }\n}\n","/**\n * Terminal Window Styles\n */\nexport const styles = `\n  :host {\n    display: block;\n    height: 100%;\n  }\n\n  * {\n    box-sizing: border-box;\n  }\n\n  /* Screen reader only content */\n  .sr-announcer {\n    position: absolute;\n    width: 1px;\n    height: 1px;\n    padding: 0;\n    margin: -1px;\n    overflow: hidden;\n    clip: rect(0, 0, 0, 0);\n    white-space: nowrap;\n    border: 0;\n  }\n\n  /* ===== CSS Custom Properties (User Customizable) ===== */\n  .terminal {\n    /* Font settings */\n    --font-family: 'Consolas', 'Monaco', 'Courier New', monospace;\n    --font-size: 14px;\n    --line-height: 1.4;\n\n    /* Cursor settings */\n    --cursor-width: 8px;\n    --cursor-height: 1.2em;\n    --cursor-blink-speed: 1s;\n  }\n\n  /* ===== DARK THEME ===== */\n  .terminal[data-theme=\"dark\"] {\n    --bg-primary: #1a1a2e;\n    --bg-secondary: #16213e;\n    --bg-header: #0f0f23;\n    --border-color: #2a2a4a;\n    --text-primary: #e0e0e0;\n    --text-secondary: #888;\n    --text-muted: #666;\n\n    --prompt-color: #50fa7b;\n    --cursor-color: #50fa7b;\n    --command-color: #f8f8f2;\n    --output-color: #e0e0e0;\n    --error-color: #ff5555;\n    --info-color: #8be9fd;\n    --success-color: #50fa7b;\n\n    --selection-bg: rgba(80, 250, 123, 0.3);\n\n    --btn-bg: #2a2a4a;\n    --btn-hover: #3a3a5a;\n    --btn-text: #e0e0e0;\n\n    --scrollbar-track: #1a1a2e;\n    --scrollbar-thumb: #3a3a5a;\n    --scrollbar-thumb-hover: #4a4a6a;\n\n    --control-close: #ff5f56;\n    --control-minimize: #ffbd2e;\n    --control-maximize: #27c93f;\n\n    --theme-icon: \"\\\\263E\"; /* Moon */\n\n    /* ANSI colors */\n    --ansi-black: #21222c;\n    --ansi-red: #ff5555;\n    --ansi-green: #50fa7b;\n    --ansi-yellow: #f1fa8c;\n    --ansi-blue: #bd93f9;\n    --ansi-magenta: #ff79c6;\n    --ansi-cyan: #8be9fd;\n    --ansi-white: #f8f8f2;\n    --ansi-bright-black: #6272a4;\n    --ansi-bright-red: #ff6e6e;\n    --ansi-bright-green: #69ff94;\n    --ansi-bright-yellow: #ffffa5;\n    --ansi-bright-blue: #d6acff;\n    --ansi-bright-magenta: #ff92df;\n    --ansi-bright-cyan: #a4ffff;\n    --ansi-bright-white: #ffffff;\n  }\n\n  /* ===== LIGHT THEME ===== */\n  .terminal[data-theme=\"light\"] {\n    --bg-primary: #fafafa;\n    --bg-secondary: #f0f0f0;\n    --bg-header: #e8e8e8;\n    --border-color: #d0d0d0;\n    --text-primary: #333;\n    --text-secondary: #666;\n    --text-muted: #999;\n\n    --prompt-color: #16a34a;\n    --cursor-color: #16a34a;\n    --command-color: #1a1a1a;\n    --output-color: #333;\n    --error-color: #dc2626;\n    --info-color: #0284c7;\n    --success-color: #16a34a;\n\n    --selection-bg: rgba(22, 163, 74, 0.2);\n\n    --btn-bg: #e0e0e0;\n    --btn-hover: #d0d0d0;\n    --btn-text: #333;\n\n    --scrollbar-track: #f0f0f0;\n    --scrollbar-thumb: #c0c0c0;\n    --scrollbar-thumb-hover: #a0a0a0;\n\n    --control-close: #ff5f56;\n    --control-minimize: #ffbd2e;\n    --control-maximize: #27c93f;\n\n    --theme-icon: \"\\\\2600\"; /* Sun */\n\n    /* ANSI colors (adjusted for light theme) */\n    --ansi-black: #000000;\n    --ansi-red: #c41a16;\n    --ansi-green: #007400;\n    --ansi-yellow: #826b28;\n    --ansi-blue: #0000ff;\n    --ansi-magenta: #a90d91;\n    --ansi-cyan: #318495;\n    --ansi-white: #666666;\n    --ansi-bright-black: #666666;\n    --ansi-bright-red: #eb3223;\n    --ansi-bright-green: #1cdc23;\n    --ansi-bright-yellow: #cdcd00;\n    --ansi-bright-blue: #5c5cff;\n    --ansi-bright-magenta: #eb3eb3;\n    --ansi-bright-cyan: #23cece;\n    --ansi-bright-white: #c7c7c7;\n  }\n\n  /* ANSI color classes */\n  .ansi-black { color: var(--ansi-black); }\n  .ansi-red { color: var(--ansi-red); }\n  .ansi-green { color: var(--ansi-green); }\n  .ansi-yellow { color: var(--ansi-yellow); }\n  .ansi-blue { color: var(--ansi-blue); }\n  .ansi-magenta { color: var(--ansi-magenta); }\n  .ansi-cyan { color: var(--ansi-cyan); }\n  .ansi-white { color: var(--ansi-white); }\n  .ansi-bright-black { color: var(--ansi-bright-black); }\n  .ansi-bright-red { color: var(--ansi-bright-red); }\n  .ansi-bright-green { color: var(--ansi-bright-green); }\n  .ansi-bright-yellow { color: var(--ansi-bright-yellow); }\n  .ansi-bright-blue { color: var(--ansi-bright-blue); }\n  .ansi-bright-magenta { color: var(--ansi-bright-magenta); }\n  .ansi-bright-cyan { color: var(--ansi-bright-cyan); }\n  .ansi-bright-white { color: var(--ansi-bright-white); }\n  .ansi-bold { font-weight: bold; }\n  .ansi-italic { font-style: italic; }\n  .ansi-underline { text-decoration: underline; }\n  .ansi-bg-black { background-color: var(--ansi-black); }\n  .ansi-bg-red { background-color: var(--ansi-red); }\n  .ansi-bg-green { background-color: var(--ansi-green); }\n  .ansi-bg-yellow { background-color: var(--ansi-yellow); }\n  .ansi-bg-blue { background-color: var(--ansi-blue); }\n  .ansi-bg-magenta { background-color: var(--ansi-magenta); }\n  .ansi-bg-cyan { background-color: var(--ansi-cyan); }\n  .ansi-bg-white { background-color: var(--ansi-white); }\n\n  /* ===== Terminal Container ===== */\n  .terminal {\n    display: flex;\n    flex-direction: column;\n    height: 100%;\n    background: var(--bg-primary);\n    border: 1px solid var(--border-color);\n    border-radius: 8px;\n    overflow: hidden;\n    font-family: var(--font-family);\n    font-size: var(--font-size);\n    line-height: var(--line-height);\n    color: var(--text-primary);\n  }\n\n  /* Focus outline for accessibility */\n  .terminal:focus-within {\n    outline: 2px solid var(--prompt-color);\n    outline-offset: 2px;\n  }\n\n  /* ===== Terminal Header ===== */\n  .terminal-header {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    padding: 10px 16px;\n    background: var(--bg-header);\n    border-bottom: 1px solid var(--border-color);\n    user-select: none;\n  }\n\n  .window-controls {\n    display: flex;\n    gap: 8px;\n  }\n\n  .control {\n    width: 12px;\n    height: 12px;\n    border-radius: 50%;\n    border: none;\n    padding: 0;\n    cursor: pointer;\n    transition: opacity 0.15s ease, transform 0.15s ease;\n  }\n\n  .control:hover {\n    opacity: 0.8;\n    transform: scale(1.1);\n  }\n\n  .control:active {\n    transform: scale(0.95);\n  }\n\n  .control.close {\n    background: var(--control-close);\n  }\n\n  .control.minimize {\n    background: var(--control-minimize);\n  }\n\n  .control.maximize {\n    background: var(--control-maximize);\n  }\n\n  .terminal-title {\n    color: var(--text-secondary);\n    font-size: 13px;\n    font-weight: 500;\n  }\n\n  .terminal-actions {\n    display: flex;\n    gap: 8px;\n    align-items: center;\n  }\n\n  /* Slot styling */\n  ::slotted([slot=\"title\"]) {\n    color: var(--text-secondary);\n    font-size: 13px;\n    font-weight: 500;\n  }\n\n  ::slotted([slot=\"actions\"]) {\n    display: flex;\n    gap: 8px;\n    align-items: center;\n  }\n\n  ::slotted([slot=\"before-output\"]) {\n    display: block;\n    margin-bottom: 8px;\n  }\n\n  .theme-btn,\n  .copy-btn {\n    padding: 4px 10px;\n    background: var(--btn-bg);\n    color: var(--btn-text);\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n    font-size: 12px;\n    font-family: inherit;\n    transition: background 0.2s;\n  }\n\n  .theme-btn {\n    padding: 4px 8px;\n    font-size: 14px;\n  }\n\n  .theme-btn::before {\n    content: var(--theme-icon);\n  }\n\n  .theme-btn:hover,\n  .copy-btn:hover {\n    background: var(--btn-hover);\n  }\n\n  .theme-btn:focus,\n  .copy-btn:focus {\n    outline: 2px solid var(--prompt-color);\n    outline-offset: 2px;\n  }\n\n  /* Copy button success state */\n  .copy-btn.copy-success {\n    background: var(--success-color, #50fa7b);\n    color: var(--bg-primary);\n  }\n\n  /* Copy menu wrapper and dropdown */\n  .copy-wrapper {\n    position: relative;\n  }\n\n  .copy-menu {\n    display: none;\n    position: absolute;\n    top: 100%;\n    right: 0;\n    margin-top: 4px;\n    background: var(--bg-secondary);\n    border: 1px solid var(--border-color);\n    border-radius: 4px;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n    z-index: 1000;\n    min-width: 160px;\n    overflow: hidden;\n  }\n\n  .copy-menu-item {\n    display: block;\n    width: 100%;\n    padding: 8px 12px;\n    background: transparent;\n    border: none;\n    color: var(--text-primary);\n    font-size: 12px;\n    font-family: inherit;\n    text-align: left;\n    cursor: pointer;\n    transition: background 0.15s;\n  }\n\n  .copy-menu-item:hover {\n    background: var(--btn-hover);\n  }\n\n  .copy-menu-item:focus {\n    background: var(--btn-hover);\n    outline: none;\n  }\n\n  /* ===== Terminal Body ===== */\n  .terminal-body {\n    flex: 1;\n    min-height: 0; /* Critical: allows flex item to shrink below content size */\n    padding: 16px;\n    overflow-y: auto;\n    overflow-x: hidden;\n  }\n\n  .terminal-body::-webkit-scrollbar {\n    width: 8px;\n  }\n\n  .terminal-body::-webkit-scrollbar-track {\n    background: var(--scrollbar-track);\n  }\n\n  .terminal-body::-webkit-scrollbar-thumb {\n    background: var(--scrollbar-thumb);\n    border-radius: 4px;\n  }\n\n  .terminal-body::-webkit-scrollbar-thumb:hover {\n    background: var(--scrollbar-thumb-hover);\n  }\n\n  /* ===== Output ===== */\n  .output {\n    margin-bottom: 4px;\n  }\n\n  .output-line {\n    padding: 2px 0;\n    white-space: pre-wrap;\n    word-break: break-word;\n  }\n\n  .output-line::selection, \n  .output-line *::selection {\n    background: var(--selection-bg);\n  }\n\n  .line-command {\n    color: var(--command-color);\n  }\n\n  .line-command .line-prompt {\n    color: var(--prompt-color);\n    font-weight: bold;\n  }\n\n  .line-output {\n    color: var(--output-color);\n  }\n\n  .line-error {\n    color: var(--error-color);\n  }\n\n  .line-info {\n    color: var(--info-color);\n  }\n\n  .line-success {\n    color: var(--success-color);\n  }\n\n  /* ===== Input Line ===== */\n  .input-line {\n    display: flex;\n    align-items: center;\n  }\n\n  .terminal[data-readonly=\"true\"] .input-line {\n    display: none;\n  }\n\n  .input-prompt {\n    color: var(--prompt-color);\n    font-weight: bold;\n    flex-shrink: 0;\n    white-space: pre;\n  }\n\n  .input-display {\n    display: flex;\n    align-items: center;\n    flex: 1;\n    min-height: 1.4em;\n  }\n\n  .input-text {\n    color: var(--command-color);\n    white-space: pre;\n  }\n\n  .hidden-input {\n    position: absolute;\n    left: -9999px;\n    opacity: 0;\n    width: 1px;\n    height: 1px;\n  }\n\n  /* ===== Cursor Styles ===== */\n  .cursor {\n    display: inline-block;\n    background: var(--cursor-color);\n    margin-left: 1px;\n  }\n\n  /* Block cursor */\n  .terminal[data-cursor-style=\"block\"] .cursor {\n    width: var(--cursor-width);\n    height: var(--cursor-height);\n  }\n\n  /* Underline cursor */\n  .terminal[data-cursor-style=\"underline\"] .cursor {\n    width: var(--cursor-width);\n    height: 2px;\n    align-self: flex-end;\n    margin-bottom: 3px;\n  }\n\n  /* Bar cursor */\n  .terminal[data-cursor-style=\"bar\"] .cursor {\n    width: 2px;\n    height: var(--cursor-height);\n  }\n\n  /* Blinking cursor animation */\n  @keyframes terminal-blink {\n    0%, 49% {\n      opacity: 1;\n    }\n    50%, 100% {\n      opacity: 0;\n    }\n  }\n\n  .terminal[data-cursor-blink=\"true\"] .cursor {\n    animation: terminal-blink var(--cursor-blink-speed) step-start infinite;\n  }\n\n  /* Typing cursor (shown during typing effect) */\n  .typing-cursor {\n    display: inline-block;\n    width: var(--cursor-width);\n    height: var(--cursor-height);\n    background: var(--cursor-color);\n    margin-left: 1px;\n    animation: terminal-blink var(--cursor-blink-speed) step-start infinite;\n  }\n\n  /* High contrast mode support */\n  @media (prefers-contrast: high) {\n    .terminal {\n      border-width: 2px;\n    }\n    .terminal:focus-within {\n      outline-width: 3px;\n    }\n  }\n\n  /* Reduced motion support */\n  @media (prefers-reduced-motion: reduce) {\n    .terminal[data-cursor-blink=\"true\"] .cursor {\n      animation: none;\n      opacity: 1;\n    }\n    .theme-btn,\n    .copy-btn,\n    .control {\n      transition: none;\n    }\n  }\n\n  /* ===== Fullscreen Mode ===== */\n  .terminal.fullscreen {\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    width: 100vw;\n    height: 100vh;\n    z-index: 99999;\n    border-radius: 0;\n    border: none;\n  }\n\n  .terminal.fullscreen .terminal-header {\n    border-radius: 0;\n  }\n`\n","import { AnsiParser } from './internals/ansi-parser.js';\nimport { CommandRegistry } from './internals/command-registry.js';\nimport { HistoryManager } from './internals/history-manager.js';\nimport { VirtualFileSystem } from './internals/file-system.js';\nimport { styles } from './styles.js';\n\n/**\n * A vanilla JavaScript web component that simulates a terminal console with\n * customizable commands, themes, cursor styles, and typing effects.\n *\n * @element terminal-window\n * @tagname terminal-window\n *\n * @attr {string} [theme=dark] - Color theme: \"dark\" or \"light\"\n * @attr {string} [prompt=\"$ \"] - The command prompt text\n * @attr {string} [title=Terminal] - Title displayed in the header bar\n * @attr {string} [cursor-style=block] - Cursor shape: \"block\", \"underline\", or \"bar\"\n * @attr {boolean} [cursor-blink=true] - Enable cursor blinking\n * @attr {string} [font-family='Consolas', 'Monaco', monospace] - Font family for terminal text\n * @attr {string} [font-size=14px] - Font size (e.g., \"14px\", \"1rem\")\n * @attr {string} [line-height=1.4] - Line height multiplier\n * @attr {boolean} [typing-effect=false] - Enable typewriter animation for output\n * @attr {number} [typing-speed=30] - Milliseconds per character when typing effect is enabled\n * @attr {boolean} [show-header=true] - Show the terminal header bar\n * @attr {boolean} [show-controls=true] - Show window control buttons (close, minimize, maximize)\n * @attr {boolean} [show-copy=true] - Show the copy button in the header\n * @attr {boolean} [show-theme-toggle=true] - Show the theme toggle button\n * @attr {boolean} [readonly=false] - Disable user input (presentation mode)\n * @attr {number} [max-lines=1000] - Maximum number of output lines to keep in buffer\n * @attr {string} [welcome] - Welcome message displayed when terminal loads\n * @attr {boolean} [enable-vfs=false] - Enable virtual file system with built-in commands (ls, cd, pwd, mkdir, touch, rm, cat)\n * @attr {boolean} [persist-history=false] - Persist command history to localStorage across sessions\n * @attr {boolean} [force-animations=false] - Force typing animations even when user has prefers-reduced-motion set\n *\n * @fires {CustomEvent} command - Fired when a command is executed. Detail: { command, args, input }\n * @fires {CustomEvent} command-result - Fired after a command executes successfully. Detail: { command, args, result }\n * @fires {CustomEvent} command-error - Fired when a command fails or is not found. Detail: { command, error }\n * @fires {CustomEvent} output - Fired when a line is printed to the terminal. Detail: { type, content }\n * @fires {CustomEvent} copy - Fired when content is copied to clipboard. Detail: { text, mode }\n * @fires {CustomEvent} close - Fired when the terminal is closed via the close button\n * @fires {CustomEvent} minimize - Fired when the terminal is minimized/restored. Detail: { minimized }\n * @fires {CustomEvent} fullscreen - Fired when fullscreen mode is toggled. Detail: { fullscreen }\n * @fires {CustomEvent} interrupt - Fired when user presses Ctrl+C\n *\n * @csspart terminal - Main terminal container\n * @csspart header - Terminal header bar\n * @csspart controls - Window controls container (close, minimize, maximize)\n * @csspart control-close - Close button\n * @csspart control-minimize - Minimize button\n * @csspart control-maximize - Maximize button\n * @csspart title - Terminal title text\n * @csspart actions - Actions container (theme toggle, copy)\n * @csspart theme-button - Theme toggle button\n * @csspart copy-button - Copy button\n * @csspart copy-menu - Copy dropdown menu\n * @csspart copy-menu-item - Copy menu items\n * @csspart body - Terminal body (scrollable area)\n * @csspart output - Output container\n * @csspart input-line - Input line container\n * @csspart prompt - Command prompt text\n * @csspart input-text - User input text\n * @csspart cursor - Cursor element\n *\n * @slot title - Custom content for the terminal title in the header\n * @slot actions - Custom buttons/actions before the theme and copy buttons\n * @slot before-output - Content inserted before the output area in the terminal body\n *\n * @cssprop [--bg-primary=#1a1a2e] - Primary background color\n * @cssprop [--bg-secondary=#16213e] - Secondary background color\n * @cssprop [--bg-header=#0f0f23] - Header background color\n * @cssprop [--border-color=#2a2a4a] - Border color\n * @cssprop [--text-primary=#e0e0e0] - Primary text color\n * @cssprop [--text-secondary=#888] - Secondary text color\n * @cssprop [--prompt-color=#50fa7b] - Prompt color\n * @cssprop [--cursor-color=#50fa7b] - Cursor color\n * @cssprop [--command-color=#f8f8f2] - Command text color\n * @cssprop [--output-color=#e0e0e0] - Output text color\n * @cssprop [--error-color=#ff5555] - Error text color\n * @cssprop [--info-color=#8be9fd] - Info text color\n * @cssprop [--success-color=#50fa7b] - Success text color\n * @cssprop [--cursor-width=8px] - Cursor width\n * @cssprop [--cursor-height=1.2em] - Cursor height\n * @cssprop [--cursor-blink-speed=1s] - Cursor blink animation speed\n * @cssprop [--btn-bg=#2a2a4a] - Button background color\n * @cssprop [--btn-hover=#3a3a5a] - Button hover background color\n * @cssprop [--btn-text=#e0e0e0] - Button text color\n * @cssprop [--control-close=#ff5f56] - Close button color\n * @cssprop [--control-minimize=#ffbd2e] - Minimize button color\n * @cssprop [--control-maximize=#27c93f] - Maximize button color\n *\n * @example\n * <terminal-window\n *   theme=\"dark\"\n *   prompt=\"$ \"\n *   title=\"My Terminal\"\n *   welcome=\"Welcome! Type 'help' for commands.\"\n * ></terminal-window>\n *\n * @example\n * // JavaScript API usage\n * const terminal = document.querySelector('terminal-window');\n * terminal.print('Hello, World!');\n * terminal.executeCommand('help');\n * terminal.registerCommand('greet', (args) => `Hello, ${args[0] || 'stranger'}!`);\n */\nclass TerminalWindow extends HTMLElement {\n  constructor() {\n    super();\n    this.attachShadow({ mode: 'open' });\n\n    // Adopt styles\n    const sheet = new CSSStyleSheet();\n    sheet.replaceSync(styles);\n    this.shadowRoot.adoptedStyleSheets = [sheet];\n\n    // Initialize internal modules\n    this.ansiParser = new AnsiParser();\n    this.commandRegistry = new CommandRegistry();\n    this.historyManager = new HistoryManager();\n    this.fileSystem = new VirtualFileSystem();\n\n    // Output lines for the terminal\n    this.outputLines = [];\n\n    // Current input value\n    this.currentInput = '';\n\n    // Input masking (for password prompts)\n    this.inputMasked = false;\n\n    // Fullscreen state\n    this.isFullscreen = false;\n\n    // Minimized state\n    this.isMinimized = false;\n\n    // Track handlers and timeouts for cleanup\n    this._fullscreenEscHandler = null;\n    this._copyMenuCloseHandler = null;\n    this._copyFeedbackTimeout = null;\n    this._announceTimeout = null;\n\n    // Copy menu state\n    this._copyMenuOpen = false;\n    this._copyMenuFocusIndex = -1;\n\n    // Auto-scroll state (smart scroll behavior)\n    this._autoScroll = true;\n    this._scrollThreshold = 50; // pixels from bottom to consider \"at bottom\"\n\n    // Typing effect state\n    this._typingInProgress = false;\n    this._typingCancelled = false;\n    this._typingQueue = [];\n\n    // Configuration with defaults\n    this.config = {\n      theme: 'dark',\n      prompt: '$ ',\n      cursorStyle: 'block', // block, underline, bar\n      cursorBlink: true,\n      fontFamily: \"'Consolas', 'Monaco', 'Courier New', monospace\",\n      fontSize: '14px',\n      lineHeight: '1.4',\n      typingEffect: false,\n      typingSpeed: 30, // ms per character\n      // Header options\n      showHeader: true,\n      title: 'Terminal',\n      showControls: true,\n      showCopy: true,\n      showThemeToggle: true,\n      // Behavior options\n      readonly: false,\n      maxLines: 1000,\n      // Features\n      enableVfs: false,\n      persistHistory: false,\n      // Accessibility\n      forceAnimations: false, // Override prefers-reduced-motion (for testing only)\n    };\n\n    // Default i18n strings (can be overridden via setI18n)\n    this._i18n = {\n      // Button labels\n      copy: 'Copy',\n      close: 'Close',\n      minimize: 'Minimize',\n      maximize: 'Maximize',\n      exitFullscreen: 'Exit fullscreen',\n      toggleFullscreen: 'Toggle fullscreen',\n      toggleTheme: 'Toggle theme',\n      switchToLight: 'switch to light',\n      switchToDark: 'switch to dark',\n      // Copy menu\n      copyAll: 'Copy All',\n      copyCommandsOnly: 'Copy Commands Only',\n      copyOutputOnly: 'Copy Output Only',\n      copyOptions: 'Copy options',\n      copied: 'Copied!',\n      nothingToCopy: 'Nothing to copy',\n      noSelection: 'No selection',\n      // Announcements\n      terminalReady: 'Terminal ready',\n      terminalCleared: 'Terminal cleared',\n      terminalClosed: 'Terminal closed',\n      terminalMinimized: 'Terminal minimized',\n      terminalRestored: 'Terminal restored',\n      enteredFullscreen: 'Entered fullscreen mode',\n      exitedFullscreen: 'Exited fullscreen mode',\n      themeChangedTo: 'Theme changed to',\n      copiedToClipboard: 'copied to clipboard',\n      content: 'Content',\n      // Built-in commands\n      availableCommands: 'Available commands:',\n      noCommandsInHistory: 'No commands in history.',\n      commandNotFound: 'Command not found:',\n      typeHelpForCommands: \"Type 'help' for available commands.\",\n      // Input\n      terminalInputLabel: 'Terminal input. Type a command and press Enter.',\n      terminalOutput: 'Terminal output',\n    };\n\n    // Register built-in commands\n    this._registerBuiltInCommands();\n\n    this.render();\n  }\n\n  connectedCallback() {\n    // Apply attributes\n    this._applyAttributes();\n    this._setupEventListeners();\n\n    if (this.config.enableVfs) {\n      this._registerVfsCommands();\n    }\n\n    // Only auto-focus if explicitly requested via autofocus attribute\n    // This prevents focus stealing in contexts like Storybook or pages with other interactive elements\n    if (!this.config.readonly && this.hasAttribute('autofocus')) {\n      this._focusInput();\n    }\n\n    // Show welcome message if provided\n    const welcome = this.getAttribute('welcome');\n    if (welcome) {\n      this.print(welcome);\n    }\n\n    // Announce to screen readers\n    this._announce(this._t('terminalReady'));\n  }\n\n  disconnectedCallback() {\n    // Remove document-level event listeners\n    if (this._fullscreenEscHandler) {\n      document.removeEventListener('keydown', this._fullscreenEscHandler);\n      this._fullscreenEscHandler = null;\n    }\n\n    if (this._copyMenuCloseHandler) {\n      document.removeEventListener('click', this._copyMenuCloseHandler);\n      this._copyMenuCloseHandler = null;\n    }\n\n    // Clear any pending timeouts\n    if (this._copyFeedbackTimeout) {\n      clearTimeout(this._copyFeedbackTimeout);\n      this._copyFeedbackTimeout = null;\n    }\n\n    if (this._announceTimeout) {\n      clearTimeout(this._announceTimeout);\n      this._announceTimeout = null;\n    }\n  }\n\n  static get observedAttributes() {\n    return [\n      'theme', 'prompt', 'cursor-style', 'cursor-blink',\n      'font-family', 'font-size', 'line-height',\n      'typing-effect', 'typing-speed',\n      'show-header', 'title', 'show-controls', 'show-copy', 'show-theme-toggle',\n      'readonly', 'max-lines', 'enable-vfs', 'persist-history', 'force-animations'\n    ];\n  }\n\n  attributeChangedCallback(name, oldValue, newValue) {\n    if (oldValue === newValue) return;\n\n    switch (name) {\n      case 'theme':\n        this.config.theme = newValue || 'dark';\n        break;\n      case 'prompt':\n        this.config.prompt = newValue || '$ ';\n        break;\n      case 'cursor-style':\n        this.config.cursorStyle = newValue || 'block';\n        break;\n      case 'cursor-blink':\n        this.config.cursorBlink = newValue !== 'false';\n        break;\n      case 'font-family':\n        this.config.fontFamily = newValue || this.config.fontFamily;\n        break;\n      case 'font-size':\n        this.config.fontSize = newValue || '14px';\n        break;\n      case 'line-height':\n        this.config.lineHeight = newValue || '1.4';\n        break;\n      case 'typing-effect':\n        this.config.typingEffect = newValue === 'true';\n        break;\n      case 'typing-speed':\n        this.config.typingSpeed = parseInt(newValue) || 30;\n        break;\n      case 'show-header':\n        this.config.showHeader = newValue !== 'false';\n        this._updateHeaderVisibility();\n        break;\n      case 'title':\n        this.config.title = newValue || 'Terminal';\n        this._updateTitle();\n        break;\n      case 'show-controls':\n        this.config.showControls = newValue !== 'false';\n        this._updateControlsVisibility();\n        break;\n      case 'show-copy':\n        this.config.showCopy = newValue !== 'false';\n        this._updateCopyVisibility();\n        break;\n      case 'show-theme-toggle':\n        this.config.showThemeToggle = newValue !== 'false';\n        this._updateThemeToggleVisibility();\n        break;\n      case 'readonly':\n        this.config.readonly = newValue === 'true' || newValue === '';\n        this._updateReadonlyState();\n        break;\n      case 'max-lines':\n        this.config.maxLines = parseInt(newValue) || 1000;\n        break;\n      case 'enable-vfs':\n        this.config.enableVfs = newValue === 'true' || newValue === '';\n        if (this.config.enableVfs) {\n          this._registerVfsCommands();\n        }\n        break;\n      case 'persist-history':\n        this.config.persistHistory = newValue === 'true' || newValue === '';\n        this.historyManager.setPersistence(this.config.persistHistory);\n        break;\n      case 'force-animations':\n        this.config.forceAnimations = newValue === 'true' || newValue === '';\n        break;\n    }\n\n    this._updateStyles();\n  }\n\n  /**\n   * Apply initial attributes\n   */\n  _applyAttributes() {\n    const attrs = TerminalWindow.observedAttributes;\n\n    attrs.forEach(attr => {\n      const value = this.getAttribute(attr);\n      if (value !== null) {\n        this.attributeChangedCallback(attr, null, value);\n      }\n    });\n\n    this._updateStyles();\n  }\n\n  /**\n   * Update dynamic styles\n   */\n  _updateStyles() {\n    const terminal = this.shadowRoot.querySelector('.terminal');\n    if (terminal) {\n      terminal.dataset.theme = this.config.theme;\n      terminal.dataset.cursorStyle = this.config.cursorStyle;\n      terminal.dataset.cursorBlink = this.config.cursorBlink;\n      terminal.dataset.readonly = this.config.readonly;\n      terminal.style.setProperty('--font-family', this.config.fontFamily);\n      terminal.style.setProperty('--font-size', this.config.fontSize);\n      terminal.style.setProperty('--line-height', this.config.lineHeight);\n    }\n\n    // Update prompt display\n    const promptEl = this.shadowRoot.querySelector('.input-prompt');\n    if (promptEl) {\n      promptEl.textContent = this.config.prompt;\n    }\n  }\n\n  /**\n   * Update header visibility\n   */\n  _updateHeaderVisibility() {\n    const header = this.shadowRoot.querySelector('.terminal-header');\n    if (header) {\n      header.style.display = this.config.showHeader ? 'flex' : 'none';\n    }\n  }\n\n  /**\n   * Update title\n   */\n  _updateTitle() {\n    const titleEl = this.shadowRoot.querySelector('.terminal-title');\n    if (titleEl) {\n      titleEl.textContent = this.config.title;\n    }\n  }\n\n  /**\n   * Update window controls visibility\n   */\n  _updateControlsVisibility() {\n    const controls = this.shadowRoot.querySelector('.window-controls');\n    if (controls) {\n      controls.style.display = this.config.showControls ? 'flex' : 'none';\n    }\n  }\n\n  /**\n   * Update copy button visibility\n   */\n  _updateCopyVisibility() {\n    const copyWrapper = this.shadowRoot.querySelector('.copy-wrapper');\n    if (copyWrapper) {\n      copyWrapper.style.display = this.config.showCopy ? '' : 'none';\n    }\n  }\n\n  /**\n   * Update theme toggle visibility\n   */\n  _updateThemeToggleVisibility() {\n    const themeBtn = this.shadowRoot.querySelector('.theme-btn');\n    if (themeBtn) {\n      themeBtn.style.display = this.config.showThemeToggle ? '' : 'none';\n    }\n  }\n\n  /**\n   * Update readonly state\n   */\n  _updateReadonlyState() {\n    const inputLine = this.shadowRoot.querySelector('.input-line');\n    if (inputLine) {\n      inputLine.style.display = this.config.readonly ? 'none' : 'flex';\n    }\n  }\n\n  /**\n   * Register VFS commands\n   */\n  _registerVfsCommands() {\n    // File system commands\n    this.registerCommand('ls', (args) => {\n      const result = this.fileSystem.ls(args[0]);\n      if (typeof result === 'string') return result;\n      \n      // Format directory listing\n      const items = result.map(item => {\n        const isDir = item.type === 'dir';\n        return isDir ? `\\x1b[1;34m${item.name}/\\x1b[0m` : item.name;\n      });\n      \n      return items.join('  ');\n    });\n\n    this.registerCommand('cd', (args) => {\n      const error = this.fileSystem.cd(args[0]);\n      if (error) return error;\n      this.setPrompt(`user@host:${this.fileSystem.getcwd()}$ `);\n      return null;\n    });\n\n    this.registerCommand('pwd', () => {\n      return this.fileSystem.getcwd();\n    });\n\n    this.registerCommand('mkdir', (args) => {\n      if (!args[0]) return 'mkdir: missing operand';\n      return this.fileSystem.mkdir(args[0]);\n    });\n\n    this.registerCommand('touch', (args) => {\n      if (!args[0]) return 'touch: missing operand';\n      return this.fileSystem.touch(args[0]);\n    });\n\n    this.registerCommand('rm', (args) => {\n      if (!args[0]) return 'rm: missing operand';\n      const recursive = args.includes('-r') || args.includes('-rf');\n      const path = args.find(a => !a.startsWith('-'));\n      if (!path) return 'rm: missing operand';\n      return this.fileSystem.rm(path, recursive);\n    });\n\n    this.registerCommand('cat', (args) => {\n      if (!args[0]) return 'cat: missing operand';\n      return this.fileSystem.readFile(args[0]);\n    });\n  }\n\n  /**\n   * Register built-in commands\n   */\n  _registerBuiltInCommands() {\n    this.registerCommand('help', () => {\n      const cmds = this.commandRegistry.getNames();\n      return `${this._t('availableCommands')}\\n${cmds.map(c => `  ${c}`).join('\\n')}`;\n    });\n\n    this.registerCommand('clear', () => {\n      this.clear();\n      return null; // Don't print anything\n    });\n\n    this.registerCommand('echo', (args) => {\n      return args.join(' ');\n    });\n\n    this.registerCommand('history', () => {\n      if (this.historyManager.isEmpty()) {\n        return this._t('noCommandsInHistory');\n      }\n      return this.historyManager.getFormattedHistory();\n    });\n\n    this.registerCommand('date', () => {\n      return new Date().toString();\n    });\n  }\n\n  /**\n   * Register a custom command handler.\n   * The handler receives an array of arguments and the terminal instance,\n   * and can return a string to print, null to suppress output, or a Promise for async commands.\n   *\n   * @method registerCommand\n   * @param {string} name - Command name (case-insensitive)\n   * @param {Function} handler - Function that receives (args: string[], terminal: TerminalWindow) and returns string|null|Promise\n   * @example\n   * // Simple command\n   * terminal.registerCommand('hello', () => 'Hello, World!');\n   *\n   * // Command with arguments\n   * terminal.registerCommand('greet', (args) => `Hello, ${args[0] || 'stranger'}!`);\n   *\n   * // Async command\n   * terminal.registerCommand('fetch-data', async (args) => {\n   *   const response = await fetch('/api/data');\n   *   const data = await response.json();\n   *   return JSON.stringify(data, null, 2);\n   * });\n   *\n   * // Command using terminal instance\n   * terminal.registerCommand('countdown', async (args, term) => {\n   *   for (let i = 3; i > 0; i--) {\n   *     await term.print(`${i}...`);\n   *     await new Promise(r => setTimeout(r, 1000));\n   *   }\n   *   return 'Blast off!';\n   * });\n   */\n  registerCommand(name, handler) {\n    this.commandRegistry.register(name, handler);\n  }\n\n  /**\n   * Remove a registered command.\n   *\n   * @method unregisterCommand\n   * @param {string} name - Command name to remove\n   * @example\n   * terminal.unregisterCommand('greet');\n   */\n  unregisterCommand(name) {\n    this.commandRegistry.unregister(name);\n  }\n\n  /**\n   * Create an alias for a command.\n   *\n   * @method registerAlias\n   * @param {string} alias - Alias name\n   * @param {string} command - Full command string to execute when alias is used\n   * @example\n   * terminal.registerAlias('ll', 'ls -la');\n   * terminal.registerAlias('cls', 'clear');\n   */\n  registerAlias(alias, command) {\n    this.commandRegistry.registerAlias(alias, command);\n  }\n\n  /**\n   * Execute a command string programmatically.\n   *\n   * @method executeCommand\n   * @param {string} input - Full command string\n   * @param {boolean} [addToHistory=true] - Whether to add to command history\n   * @returns {Promise<void>}\n   * @example\n   * terminal.executeCommand('ls -la');\n   * terminal.executeCommand('help', false); // Don't add to history\n   */\n  async executeCommand(input, addToHistory = true) {\n    const trimmed = input.trim();\n    if (!trimmed) return;\n\n    // Add to history\n    if (addToHistory) {\n      this.historyManager.add(trimmed);\n    }\n\n    // Print the command line\n    this._printCommandLine(trimmed);\n\n    // Resolve alias\n    const resolved = this.commandRegistry.resolveAlias(trimmed);\n\n    // Parse command and arguments\n    const parts = this.commandRegistry.parse(resolved);\n    const cmdName = parts[0].toLowerCase();\n    const args = parts.slice(1);\n\n    // Find and execute command\n    const handler = this.commandRegistry.get(cmdName);\n\n    if (handler) {\n      try {\n        const result = await handler(args, this);\n        if (result !== null && result !== undefined) {\n          await this.print(String(result));\n        }\n\n        // Dispatch command-result event on success\n        this.dispatchEvent(new CustomEvent('command-result', {\n          detail: { command: cmdName, args, input: trimmed, result },\n          bubbles: true,\n          composed: true\n        }));\n      } catch (error) {\n        await this.print(`Error: ${error.message}`, 'error');\n\n        // Dispatch command-error event on failure\n        this.dispatchEvent(new CustomEvent('command-error', {\n          detail: { command: cmdName, args, input: trimmed, error },\n          bubbles: true,\n          composed: true\n        }));\n      }\n    } else {\n      const errorMessage = `${this._t('commandNotFound')} ${cmdName}. ${this._t('typeHelpForCommands')}`;\n      await this.print(errorMessage, 'error');\n\n      // Dispatch command-error for unknown commands\n      this.dispatchEvent(new CustomEvent('command-error', {\n        detail: { command: cmdName, args, input: trimmed, error: new Error(errorMessage) },\n        bubbles: true,\n        composed: true\n      }));\n    }\n\n    // Dispatch command event (fired for all commands)\n    this.dispatchEvent(new CustomEvent('command', {\n      detail: { command: cmdName, args, input: trimmed },\n      bubbles: true,\n      composed: true\n    }));\n  }\n\n  /**\n   * Execute multiple commands with delays between them.\n   * Useful for demos, presentations, or scripted terminal sequences.\n   *\n   * @method executeSequence\n   * @param {Array<string|{command: string, delay?: number}>} commands - Array of command strings or objects with command and optional delay\n   * @param {number} [defaultDelay=1000] - Default delay between commands in milliseconds\n   * @returns {Promise<void>}\n   * @example\n   * // Simple array of command strings\n   * await terminal.executeSequence(['pwd', 'ls', 'whoami'], 1000);\n   *\n   * // With custom delays per command\n   * await terminal.executeSequence([\n   *   { command: 'cd /home', delay: 500 },\n   *   { command: 'ls -la', delay: 1500 },\n   *   'pwd' // Uses default delay\n   * ], 1000);\n   */\n  async executeSequence(commands, defaultDelay = 1000) {\n    for (const item of commands) {\n      const command = typeof item === 'string' ? item : item.command;\n      const delay = typeof item === 'string' ? defaultDelay : (item.delay ?? defaultDelay);\n\n      await this.executeCommand(command, false);\n      await this._delay(delay);\n    }\n  }\n\n  /**\n   * Print command line to output\n   */\n  _printCommandLine(input) {\n    const line = {\n      type: 'command',\n      prompt: this.config.prompt,\n      content: input\n    };\n    this.outputLines.push(line);\n    \n    // Efficiently append to DOM\n    this._appendLineToDom(line);\n    this._trimOutputIfNeeded();\n    this._scrollToBottom();\n  }\n\n  /**\n   * Print text to the terminal.\n   * Supports multiple lines (splits on \\n) and ANSI color codes.\n   *\n   * @method print\n   * @param {string} text - Text to print (can contain newlines)\n   * @param {string} [type=output] - Line type for styling: \"output\" (default), \"error\" (red), \"info\" (cyan), \"success\" (green)\n   * @returns {Promise<void>}\n   * @example\n   * terminal.print('Operation complete!', 'success');\n   * terminal.print('Something went wrong', 'error');\n   * terminal.print('Processing...', 'info');\n   *\n   * // With ANSI colors\n   * terminal.print('\\x1b[31mRed text\\x1b[0m');\n   */\n  async print(text, type = 'output') {\n    const lines = text.split('\\n');\n\n    for (const lineText of lines) {\n      const line = {\n        type: type,\n        content: lineText\n      };\n      this.outputLines.push(line);\n\n      // Dispatch output event for each line\n      this.dispatchEvent(new CustomEvent('output', {\n        detail: { type, content: lineText },\n        bubbles: true,\n        composed: true\n      }));\n      \n      // Efficiently append to DOM (if not typing effect)\n      if (!this.config.typingEffect || type === 'command' || this._prefersReducedMotion()) {\n        this._appendLineToDom(line);\n      }\n    }\n    \n    // Check if typing effect should be used\n    const useTypingEffect = this.config.typingEffect &&\n                            type !== 'command' &&\n                            !this._prefersReducedMotion();\n\n    if (useTypingEffect) {\n      // Queue this print if typing is already in progress\n      if (this._typingInProgress) {\n        await new Promise(resolve => {\n          this._typingQueue.push({ lines, type, resolve });\n        });\n      } else {\n        await this._renderWithTypingEffect(lines, type);\n        // Process any queued prints\n        await this._processTypingQueue();\n      }\n    }\n\n    this._trimOutputIfNeeded();\n    this._scrollToBottom();\n\n    // Announce to screen readers for important output\n    if (type === 'error') {\n      this._announce(`Error: ${text}`);\n    }\n  }\n\n  /**\n   * Check if user prefers reduced motion\n   * Can be overridden with forceAnimations config for testing\n   */\n  _prefersReducedMotion() {\n    if (this.config.forceAnimations) {\n      return false; // Override: allow animations regardless of system preference\n    }\n    return window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;\n  }\n\n  /**\n   * Process queued typing effect prints\n   */\n  async _processTypingQueue() {\n    while (this._typingQueue.length > 0) {\n      const { lines, type, resolve } = this._typingQueue.shift();\n      await this._renderWithTypingEffect(lines, type);\n      resolve();\n    }\n  }\n\n  /**\n   * Trim output lines if exceeding max\n   */\n  _trimOutputIfNeeded() {\n    const outputContainer = this.shadowRoot.querySelector('.output');\n    \n    // Trim array\n    while (this.outputLines.length > this.config.maxLines) {\n      this.outputLines.shift();\n      // Remove corresponding element from DOM\n      if (outputContainer && outputContainer.firstElementChild) {\n        outputContainer.removeChild(outputContainer.firstElementChild);\n      }\n    }\n  }\n\n  /**\n   * Render output with typing effect\n   */\n  async _renderWithTypingEffect(lines, type) {\n    this._typingInProgress = true;\n    this._typingCancelled = false;\n\n    const outputContainer = this.shadowRoot.querySelector('.output');\n    const inputCursor = this.shadowRoot.querySelector('.input-line .cursor');\n\n    // Hide the input cursor during typing effect\n    if (inputCursor) {\n      inputCursor.style.visibility = 'hidden';\n    }\n\n    // Create a typing cursor element\n    const typingCursor = document.createElement('span');\n    typingCursor.className = 'typing-cursor';\n\n    for (const lineText of lines) {\n      // Check if cancelled - if so, render remaining lines immediately\n      if (this._typingCancelled) {\n        // We need to render the remaining lines properly\n        // Find the index of current line in lines array and render the rest\n        const currentIndex = lines.indexOf(lineText);\n        for (let i = currentIndex; i < lines.length; i++) {\n            this._appendLineToDom({ type, content: lines[i] });\n        }\n        break;\n      }\n\n      const lineEl = document.createElement('div');\n      lineEl.className = `output-line line-${type}`;\n      lineEl.setAttribute('role', 'listitem');\n      outputContainer.appendChild(lineEl);\n\n      // Build up the raw text character by character, then parse ANSI at each step\n      let rawText = '';\n      for (let i = 0; i < lineText.length; i++) {\n        // Check if cancelled mid-line\n        if (this._typingCancelled) {\n          // Complete this line immediately\n          lineEl.innerHTML = this._parseAnsi(lineText);\n          break;\n        }\n\n        rawText += lineText[i];\n        lineEl.innerHTML = this._parseAnsi(rawText);\n        lineEl.appendChild(typingCursor);\n        this._scrollToBottom();\n        await this._delay(this.config.typingSpeed);\n      }\n      // Remove cursor from this line when done\n      if (typingCursor.parentNode === lineEl) {\n        lineEl.removeChild(typingCursor);\n      }\n    }\n\n    // Show the input cursor again\n    if (inputCursor) {\n      inputCursor.style.visibility = 'visible';\n    }\n\n    this._typingInProgress = false;\n    this._typingCancelled = false;\n  }\n\n  /**\n   * Skip the current typing animation and show all remaining output immediately.\n   * This is also triggered when the user presses Ctrl+C or clicks the terminal during a typing effect.\n   *\n   * @method skipTypingEffect\n   * @example\n   * terminal.skipTypingEffect();\n   */\n  skipTypingEffect() {\n    if (this._typingInProgress) {\n      this._typingCancelled = true;\n    }\n  }\n\n  /**\n   * Delay helper for typing effect\n   * @private\n   */\n  _delay(ms) {\n    return new Promise(resolve => setTimeout(resolve, ms));\n  }\n\n  /**\n   * Clear all terminal output.\n   *\n   * @method clear\n   * @example\n   * terminal.clear();\n   */\n  clear() {\n    this.outputLines = [];\n    const outputContainer = this.shadowRoot.querySelector('.output');\n    if (outputContainer) {\n      outputContainer.innerHTML = '';\n    }\n    this._announce(this._t('terminalCleared'));\n  }\n\n  /**\n   * Parse ANSI escape codes and convert to HTML\n   * @param {string} text - Text with ANSI codes\n   * @returns {string} HTML string\n   */\n  _parseAnsi(text) {\n    return this.ansiParser.parse(text, this._escapeHtml.bind(this));\n  }\n\n  /**\n   * Append a single line to the DOM\n   */\n  _appendLineToDom(line) {\n    const outputContainer = this.shadowRoot.querySelector('.output');\n    if (!outputContainer) return;\n\n    const div = document.createElement('div');\n    \n    if (line.type === 'command') {\n      div.className = 'output-line line-command';\n      div.setAttribute('role', 'listitem');\n      div.innerHTML = `<span class=\"line-prompt\">${this._escapeHtml(line.prompt)}</span>${this._escapeHtml(line.content)}`;\n    } else {\n      div.className = `output-line line-${line.type}`;\n      div.setAttribute('role', 'listitem');\n      // Parse ANSI codes for non-command lines\n      div.innerHTML = this._parseAnsi(line.content);\n    }\n    \n    outputContainer.appendChild(div);\n  }\n\n  /**\n   * Render the output area\n   */\n  _renderOutput() {\n    const outputContainer = this.shadowRoot.querySelector('.output');\n    if (!outputContainer) return;\n\n    outputContainer.innerHTML = '';\n    \n    this.outputLines.forEach(line => {\n      this._appendLineToDom(line);\n    });\n\n    this._scrollToBottom();\n  }\n\n  /**\n   * Check if terminal is scrolled near the bottom\n   */\n  _isNearBottom() {\n    const terminal = this.shadowRoot.querySelector('.terminal-body');\n    if (!terminal) return true;\n    const distanceFromBottom = terminal.scrollHeight - terminal.scrollTop - terminal.clientHeight;\n    return distanceFromBottom <= this._scrollThreshold;\n  }\n\n  /**\n   * Handle scroll events for smart auto-scroll\n   */\n  _handleScroll() {\n    // Re-enable auto-scroll if user scrolls to bottom\n    this._autoScroll = this._isNearBottom();\n  }\n\n  /**\n   * Scroll to bottom of terminal (respects auto-scroll setting)\n   */\n  _scrollToBottom() {\n    if (!this._autoScroll) return;\n\n    const terminal = this.shadowRoot.querySelector('.terminal-body');\n    if (terminal) {\n      terminal.scrollTop = terminal.scrollHeight;\n    }\n  }\n\n  /**\n   * Force scroll to the bottom of the terminal.\n   * The terminal uses smart auto-scroll: it automatically scrolls when new output appears,\n   * but stops if the user scrolls up to read previous content. This method forces a scroll\n   * and re-enables auto-scroll.\n   *\n   * @method scrollToBottom\n   * @example\n   * terminal.scrollToBottom();\n   */\n  scrollToBottom() {\n    this._autoScroll = true;\n    const terminal = this.shadowRoot.querySelector('.terminal-body');\n    if (terminal) {\n      terminal.scrollTop = terminal.scrollHeight;\n    }\n  }\n\n  /**\n   * Escape HTML for safe display\n   */\n  _escapeHtml(text) {\n    const div = document.createElement('div');\n    div.textContent = text;\n    return div.innerHTML;\n  }\n\n  /**\n   * Announce message to screen readers\n   */\n  _announce(message) {\n    const announcer = this.shadowRoot.querySelector('.sr-announcer');\n    if (announcer) {\n      announcer.textContent = message;\n      // Clear after announcement\n      if (this._announceTimeout) {\n        clearTimeout(this._announceTimeout);\n      }\n      this._announceTimeout = setTimeout(() => {\n        announcer.textContent = '';\n        this._announceTimeout = null;\n      }, 1000);\n    }\n  }\n\n  /**\n   * Setup event listeners\n   */\n  _setupEventListeners() {\n    const input = this.shadowRoot.querySelector('.hidden-input');\n    const terminal = this.shadowRoot.querySelector('.terminal');\n    const terminalBody = this.shadowRoot.querySelector('.terminal-body');\n\n    // Smart scroll: track when user scrolls away from bottom\n    if (terminalBody) {\n      terminalBody.addEventListener('scroll', () => this._handleScroll());\n    }\n\n    // Focus input when clicking anywhere in terminal\n    // Also skip typing effect if in progress\n    // But don't steal focus if user is selecting text\n    terminal.addEventListener('click', () => {\n      if (this._typingInProgress) {\n        this.skipTypingEffect();\n      }\n      if (!this.config.readonly) {\n        // Check if user has selected text - if so, don't steal focus\n        const selection = this.shadowRoot.getSelection ?\n          this.shadowRoot.getSelection() :\n          window.getSelection();\n        const hasSelection = selection && selection.toString().length > 0;\n\n        if (!hasSelection) {\n          this._focusInput();\n        }\n      }\n    });\n\n    // Handle input\n    input.addEventListener('input', (e) => {\n      this.currentInput = e.target.value;\n      this._updateInputDisplay();\n    });\n\n    // Handle keydown\n    input.addEventListener('keydown', (e) => {\n      if (this.config.readonly) return;\n\n      switch (e.key) {\n        case 'Enter':\n          e.preventDefault();\n          const cmd = this.currentInput;\n          this.currentInput = '';\n          input.value = '';\n          this._updateInputDisplay();\n          this.executeCommand(cmd);\n          break;\n\n        case 'ArrowUp':\n          e.preventDefault();\n          this._navigateHistory(-1);\n          break;\n\n        case 'ArrowDown':\n          e.preventDefault();\n          this._navigateHistory(1);\n          break;\n\n        case 'Tab':\n          e.preventDefault();\n          this._autocomplete();\n          break;\n\n        case 'c':\n          if (e.ctrlKey) {\n            e.preventDefault();\n            // Skip typing effect if in progress\n            if (this._typingInProgress) {\n              this.skipTypingEffect();\n            } else {\n              this._printCommandLine(this.currentInput + '^C');\n              this.currentInput = '';\n              input.value = '';\n              this._updateInputDisplay();\n            }\n            this.dispatchEvent(new CustomEvent('interrupt', { bubbles: true, composed: true }));\n          }\n          break;\n\n        case 'l':\n          if (e.ctrlKey) {\n            e.preventDefault();\n            this.clear();\n          }\n          break;\n      }\n    });\n\n    // Copy button with menu\n    const copyBtn = this.shadowRoot.querySelector('.copy-btn');\n    const copyMenu = this.shadowRoot.querySelector('.copy-menu');\n    if (copyBtn && copyMenu) {\n      // Single click copies all, shows brief feedback\n      copyBtn.addEventListener('click', (e) => {\n        if (e.detail === 1) {\n          // Single click - copy all immediately\n          this.copyContent('all');\n        }\n      });\n\n      // Right-click or long-press shows menu\n      copyBtn.addEventListener('contextmenu', (e) => {\n        e.preventDefault();\n        this._toggleCopyMenu();\n      });\n\n      // Keyboard support for copy button - Enter/Space opens menu\n      copyBtn.addEventListener('keydown', (e) => {\n        if (e.key === 'Enter' || e.key === ' ') {\n          // Allow default click behavior for single action\n          // But ArrowDown opens the menu\n        } else if (e.key === 'ArrowDown') {\n          e.preventDefault();\n          this._openCopyMenu();\n        }\n      });\n\n      // Handle menu items\n      copyMenu.querySelectorAll('.copy-menu-item').forEach(item => {\n        item.addEventListener('click', (e) => {\n          e.stopPropagation();\n          const mode = item.dataset.copyMode;\n          this.copyContent(mode);\n          this._closeCopyMenu();\n        });\n\n        // Keyboard support for menu items\n        item.addEventListener('keydown', (e) => {\n          if (e.key === 'Enter' || e.key === ' ') {\n            e.preventDefault();\n            const mode = item.dataset.copyMode;\n            this.copyContent(mode);\n            this._closeCopyMenu();\n          } else {\n            this._handleCopyMenuKeydown(e);\n          }\n        });\n      });\n    }\n\n    // Theme toggle\n    const themeBtn = this.shadowRoot.querySelector('.theme-btn');\n    if (themeBtn) {\n      themeBtn.addEventListener('click', () => this.toggleTheme());\n    }\n\n    // Window controls (traffic light buttons)\n    const closeBtn = this.shadowRoot.querySelector('.control.close');\n    const minimizeBtn = this.shadowRoot.querySelector('.control.minimize');\n    const maximizeBtn = this.shadowRoot.querySelector('.control.maximize');\n\n    if (closeBtn) {\n      closeBtn.addEventListener('click', (e) => {\n        e.stopPropagation();\n        this.close();\n      });\n    }\n\n    if (minimizeBtn) {\n      minimizeBtn.addEventListener('click', (e) => {\n        e.stopPropagation();\n        this.minimize();\n      });\n    }\n\n    if (maximizeBtn) {\n      maximizeBtn.addEventListener('click', (e) => {\n        e.stopPropagation();\n        this.toggleFullscreen();\n      });\n    }\n  }\n\n  /**\n   * Navigate command history\n   */\n  _navigateHistory(direction) {\n    const result = this.historyManager.navigate(direction);\n    if (result !== null) {\n      this.currentInput = result;\n      const input = this.shadowRoot.querySelector('.hidden-input');\n      input.value = this.currentInput;\n      this._updateInputDisplay();\n    }\n  }\n\n  /**\n   * Autocomplete command\n   */\n  _autocomplete() {\n    const parts = this.currentInput.split(' ');\n    const cmdPart = parts[0].toLowerCase();\n\n    if (parts.length === 1 && cmdPart) {\n      const matches = this.commandRegistry.getNames()\n        .filter(c => c.startsWith(cmdPart));\n\n      if (matches.length === 1) {\n        this.currentInput = matches[0];\n        const input = this.shadowRoot.querySelector('.hidden-input');\n        input.value = this.currentInput;\n        this._updateInputDisplay();\n      } else if (matches.length > 1) {\n        this.print(matches.join('  '), 'info');\n      }\n    }\n  }\n\n  /**\n   * Update the visible input display\n   */\n  _updateInputDisplay() {\n    const inputText = this.shadowRoot.querySelector('.input-text');\n    if (inputText) {\n      if (this.inputMasked) {\n        inputText.textContent = '*'.repeat(this.currentInput.length);\n      } else {\n        inputText.textContent = this.currentInput;\n      }\n    }\n  }\n\n  /**\n   * Focus the hidden input\n   */\n  _focusInput() {\n    const input = this.shadowRoot.querySelector('.hidden-input');\n    if (input && !this.config.readonly) {\n      input.focus();\n    }\n  }\n\n  /**\n   * Enable or disable input masking for password prompts.\n   * When masked, input is displayed as asterisks (***) instead of the actual characters.\n   *\n   * @method setInputMask\n   * @param {boolean} masked - Whether to mask input\n   * @example\n   * terminal.setInputMask(true);  // Shows *** instead of text\n   * terminal.setInputMask(false); // Shows normal text\n   */\n  setInputMask(masked) {\n    this.inputMasked = masked;\n    this._updateInputDisplay();\n  }\n\n  /**\n   * Copy terminal content to clipboard.\n   *\n   * @method copyContent\n   * @param {string} [mode=all] - Copy mode: \"all\" (everything with prompts), \"commands\" (only commands entered), \"output\" (only output, no commands), \"selection\" (current text selection)\n   * @returns {Promise<void>}\n   * @example\n   * terminal.copyContent('commands'); // Copy only commands entered\n   * terminal.copyContent('output');   // Copy only output\n   * terminal.copyContent('all');      // Copy everything\n   */\n  async copyContent(mode = 'all') {\n    let text;\n\n    switch (mode) {\n      case 'commands':\n        // Copy only command lines (without prompts)\n        text = this.outputLines\n          .filter(line => line.type === 'command')\n          .map(line => line.content)\n          .join('\\n');\n        break;\n      case 'output':\n        // Copy only output (no commands)\n        text = this.outputLines\n          .filter(line => line.type !== 'command')\n          .map(line => line.content)\n          .join('\\n');\n        break;\n      case 'selection':\n        // Copy current text selection\n        const selection = this.shadowRoot.getSelection ?\n          this.shadowRoot.getSelection() :\n          window.getSelection();\n        text = selection ? selection.toString() : '';\n        if (!text) {\n          this._showCopyFeedback(this._t('noSelection'));\n          return;\n        }\n        break;\n      case 'all':\n      default:\n        // Copy everything with prompts\n        text = this.outputLines.map(line => {\n          if (line.type === 'command') {\n            return `${line.prompt}${line.content}`;\n          }\n          return line.content;\n        }).join('\\n');\n    }\n\n    if (!text) {\n      this._showCopyFeedback(this._t('nothingToCopy'));\n      return;\n    }\n\n    await this._copyToClipboard(text, mode);\n  }\n\n  /**\n   * Internal method to copy text to clipboard\n   */\n  async _copyToClipboard(text, mode = 'all') {\n    const modeLabel = mode === 'all' ? this._t('content') : mode.charAt(0).toUpperCase() + mode.slice(1);\n    const announcement = `${modeLabel} ${this._t('copiedToClipboard')}`;\n\n    try {\n      await navigator.clipboard.writeText(text);\n      this._showCopyFeedback(this._t('copied'));\n      this._announce(announcement);\n    } catch (err) {\n      // Fallback for older browsers\n      const textarea = document.createElement('textarea');\n      textarea.value = text;\n      textarea.style.position = 'fixed';\n      textarea.style.opacity = '0';\n      document.body.appendChild(textarea);\n      textarea.select();\n      document.execCommand('copy');\n      document.body.removeChild(textarea);\n      this._showCopyFeedback(this._t('copied'));\n      this._announce(announcement);\n    }\n\n    this.dispatchEvent(new CustomEvent('copy', {\n      detail: { text, mode },\n      bubbles: true,\n      composed: true\n    }));\n  }\n\n  /**\n   * Toggle copy menu visibility\n   */\n  _toggleCopyMenu() {\n    if (this._copyMenuOpen) {\n      this._closeCopyMenu();\n    } else {\n      this._openCopyMenu();\n    }\n  }\n\n  /**\n   * Open the copy menu with keyboard support\n   */\n  _openCopyMenu() {\n    const menu = this.shadowRoot.querySelector('.copy-menu');\n    const copyBtn = this.shadowRoot.querySelector('.copy-btn');\n    if (!menu) return;\n\n    menu.style.display = 'block';\n    this._copyMenuOpen = true;\n    this._copyMenuFocusIndex = 0;\n\n    // Update ARIA state\n    if (copyBtn) {\n      copyBtn.setAttribute('aria-expanded', 'true');\n    }\n\n    // Focus first menu item\n    const items = menu.querySelectorAll('.copy-menu-item');\n    if (items.length > 0) {\n      items[0].focus();\n    }\n\n    // Close menu when clicking outside\n    this._copyMenuCloseHandler = (e) => {\n      if (!e.composedPath().includes(menu) && !e.composedPath().includes(copyBtn)) {\n        this._closeCopyMenu();\n      }\n    };\n    setTimeout(() => document.addEventListener('click', this._copyMenuCloseHandler), 0);\n  }\n\n  /**\n   * Close the copy menu and return focus\n   */\n  _closeCopyMenu() {\n    const menu = this.shadowRoot.querySelector('.copy-menu');\n    const copyBtn = this.shadowRoot.querySelector('.copy-btn');\n\n    if (menu) {\n      menu.style.display = 'none';\n    }\n\n    this._copyMenuOpen = false;\n    this._copyMenuFocusIndex = -1;\n\n    // Update ARIA state\n    if (copyBtn) {\n      copyBtn.setAttribute('aria-expanded', 'false');\n      copyBtn.focus();\n    }\n\n    // Remove click handler\n    if (this._copyMenuCloseHandler) {\n      document.removeEventListener('click', this._copyMenuCloseHandler);\n      this._copyMenuCloseHandler = null;\n    }\n  }\n\n  /**\n   * Handle keyboard navigation in copy menu\n   */\n  _handleCopyMenuKeydown(e) {\n    const menu = this.shadowRoot.querySelector('.copy-menu');\n    if (!menu || !this._copyMenuOpen) return;\n\n    const items = menu.querySelectorAll('.copy-menu-item');\n    if (items.length === 0) return;\n\n    switch (e.key) {\n      case 'ArrowDown':\n        e.preventDefault();\n        this._copyMenuFocusIndex = (this._copyMenuFocusIndex + 1) % items.length;\n        items[this._copyMenuFocusIndex].focus();\n        break;\n\n      case 'ArrowUp':\n        e.preventDefault();\n        this._copyMenuFocusIndex = (this._copyMenuFocusIndex - 1 + items.length) % items.length;\n        items[this._copyMenuFocusIndex].focus();\n        break;\n\n      case 'Escape':\n        e.preventDefault();\n        this._closeCopyMenu();\n        break;\n\n      case 'Tab':\n        // Close menu on tab out\n        this._closeCopyMenu();\n        break;\n\n      case 'Home':\n        e.preventDefault();\n        this._copyMenuFocusIndex = 0;\n        items[0].focus();\n        break;\n\n      case 'End':\n        e.preventDefault();\n        this._copyMenuFocusIndex = items.length - 1;\n        items[items.length - 1].focus();\n        break;\n    }\n  }\n\n  /**\n   * Show copy feedback\n   */\n  _showCopyFeedback(message) {\n    const copyBtn = this.shadowRoot.querySelector('.copy-btn');\n    if (!copyBtn) return;\n    const originalText = copyBtn.textContent;\n    copyBtn.textContent = message;\n    copyBtn.classList.add('copy-success');\n    if (this._copyFeedbackTimeout) {\n      clearTimeout(this._copyFeedbackTimeout);\n    }\n    this._copyFeedbackTimeout = setTimeout(() => {\n      copyBtn.textContent = originalText;\n      copyBtn.classList.remove('copy-success');\n      this._copyFeedbackTimeout = null;\n      this._focusInput();\n    }, 1500);\n  }\n\n  /**\n   * Toggle between light and dark theme.\n   * Announces the theme change to screen readers and fires no events (use attribute observation for reactivity).\n   *\n   * @method toggleTheme\n   * @returns {void}\n   * @example\n   * terminal.toggleTheme(); // Switches from dark to light or vice versa\n   */\n  toggleTheme() {\n    this.config.theme = this.config.theme === 'dark' ? 'light' : 'dark';\n    this.setAttribute('theme', this.config.theme);\n    this._updateStyles();\n    this._announce(`${this._t('themeChangedTo')} ${this.config.theme}`);\n  }\n\n  /**\n   * Close the terminal by hiding it.\n   * Sets `display: none` on the element and dispatches a `close` event.\n   * The terminal can be shown again by setting `display: block` or removing the style.\n   *\n   * @method close\n   * @returns {void}\n   * @fires close\n   * @example\n   * terminal.close();\n   *\n   * // Listen for close event\n   * terminal.addEventListener('close', () => {\n   *   console.log('Terminal was closed');\n   * });\n   */\n  close() {\n    this.style.display = 'none';\n    this._announce(this._t('terminalClosed'));\n\n    this.dispatchEvent(new CustomEvent('close', {\n      bubbles: true,\n      composed: true\n    }));\n  }\n\n  /**\n   * Toggle the minimized state of the terminal.\n   * When minimized, only the header is visible. Dispatches a `minimize` event with the new state.\n   *\n   * @method minimize\n   * @returns {void}\n   * @fires minimize\n   * @example\n   * terminal.minimize(); // Minimize the terminal\n   * terminal.minimize(); // Restore the terminal\n   *\n   * // Listen for minimize event\n   * terminal.addEventListener('minimize', (e) => {\n   *   console.log('Minimized:', e.detail.minimized);\n   * });\n   */\n  minimize() {\n    this.isMinimized = !this.isMinimized;\n    const terminalBody = this.shadowRoot.querySelector('.terminal-body');\n\n    if (terminalBody) {\n      terminalBody.style.display = this.isMinimized ? 'none' : 'block';\n    }\n\n    this._announce(this.isMinimized ? this._t('terminalMinimized') : this._t('terminalRestored'));\n\n    this.dispatchEvent(new CustomEvent('minimize', {\n      detail: { minimized: this.isMinimized },\n      bubbles: true,\n      composed: true\n    }));\n\n    // Return focus to input when restoring from minimized state\n    if (!this.isMinimized) {\n      this._focusInput();\n    }\n  }\n\n  /**\n   * Toggle fullscreen mode (maximize).\n   * When fullscreen, the terminal fills the entire viewport. Press Escape to exit.\n   * Dispatches a `fullscreen` event with the new state.\n   *\n   * @method toggleFullscreen\n   * @returns {void}\n   * @fires fullscreen\n   * @example\n   * terminal.toggleFullscreen(); // Enter fullscreen\n   * terminal.toggleFullscreen(); // Exit fullscreen\n   *\n   * // Listen for fullscreen event\n   * terminal.addEventListener('fullscreen', (e) => {\n   *   console.log('Fullscreen:', e.detail.fullscreen);\n   * });\n   */\n  toggleFullscreen() {\n    this.isFullscreen = !this.isFullscreen;\n    const terminal = this.shadowRoot.querySelector('.terminal');\n    const maximizeBtn = this.shadowRoot.querySelector('.control.maximize');\n\n    if (terminal) {\n      terminal.classList.toggle('fullscreen', this.isFullscreen);\n    }\n\n    if (maximizeBtn) {\n      maximizeBtn.title = this.isFullscreen ? this._t('exitFullscreen') : this._t('maximize');\n      maximizeBtn.setAttribute('aria-label', this.isFullscreen ? this._t('exitFullscreen') : this._t('toggleFullscreen'));\n      maximizeBtn.setAttribute('aria-pressed', this.isFullscreen ? 'true' : 'false');\n    }\n\n    // Handle escape key to exit fullscreen\n    if (this.isFullscreen) {\n      this._fullscreenEscHandler = (e) => {\n        if (e.key === 'Escape') {\n          this.toggleFullscreen();\n        }\n      };\n      document.addEventListener('keydown', this._fullscreenEscHandler);\n    } else if (this._fullscreenEscHandler) {\n      document.removeEventListener('keydown', this._fullscreenEscHandler);\n      this._fullscreenEscHandler = null;\n    }\n\n    this._announce(this.isFullscreen ? this._t('enteredFullscreen') : this._t('exitedFullscreen'));\n\n    this.dispatchEvent(new CustomEvent('fullscreen', {\n      detail: { fullscreen: this.isFullscreen },\n      bubbles: true,\n      composed: true\n    }));\n\n    this._focusInput();\n  }\n\n  /**\n   * Set the color theme programmatically.\n   *\n   * @method setTheme\n   * @param {('dark'|'light')} theme - The theme to apply\n   * @returns {void}\n   * @example\n   * terminal.setTheme('light');\n   * terminal.setTheme('dark');\n   */\n  setTheme(theme) {\n    this.config.theme = theme;\n    this.setAttribute('theme', theme);\n    this._updateStyles();\n  }\n\n  /**\n   * Set the command prompt text programmatically.\n   *\n   * @method setPrompt\n   * @param {string} prompt - The prompt text to display (e.g., \"$ \", \"> \", \"user@host:~$ \")\n   * @returns {void}\n   * @example\n   * terminal.setPrompt('> ');\n   * terminal.setPrompt('user@localhost:~$ ');\n   */\n  setPrompt(prompt) {\n    this.config.prompt = prompt;\n    this.setAttribute('prompt', prompt);\n    this._updateStyles();\n  }\n\n  /**\n   * Set the cursor style programmatically.\n   *\n   * @method setCursorStyle\n   * @param {('block'|'underline'|'bar')} style - The cursor style to apply\n   * @returns {void}\n   * @example\n   * terminal.setCursorStyle('block');     //  (default)\n   * terminal.setCursorStyle('underline'); // _\n   * terminal.setCursorStyle('bar');       // |\n   */\n  setCursorStyle(style) {\n    this.config.cursorStyle = style;\n    this.setAttribute('cursor-style', style);\n    this._updateStyles();\n  }\n\n  /**\n   * Enable or disable cursor blinking programmatically.\n   *\n   * @method setCursorBlink\n   * @param {boolean} blink - Whether the cursor should blink\n   * @returns {void}\n   * @example\n   * terminal.setCursorBlink(true);  // Enable blinking\n   * terminal.setCursorBlink(false); // Disable blinking (solid cursor)\n   */\n  setCursorBlink(blink) {\n    this.config.cursorBlink = blink;\n    this.setAttribute('cursor-blink', String(blink));\n    this._updateStyles();\n  }\n\n  /**\n   * Enable or disable the typing effect for output.\n   * When enabled, printed text appears character by character like a typewriter.\n   * Respects `prefers-reduced-motion` unless `force-animations` is set.\n   *\n   * @method setTypingEffect\n   * @param {boolean} enabled - Whether to enable the typing effect\n   * @param {number} [speed=30] - Milliseconds per character (lower = faster)\n   * @returns {void}\n   * @example\n   * terminal.setTypingEffect(true);        // Enable with default speed (30ms)\n   * terminal.setTypingEffect(true, 10);    // Enable with fast typing (10ms)\n   * terminal.setTypingEffect(true, 100);   // Enable with slow typing (100ms)\n   * terminal.setTypingEffect(false);       // Disable typing effect\n   */\n  setTypingEffect(enabled, speed = 30) {\n    this.config.typingEffect = enabled;\n    this.config.typingSpeed = speed;\n    this.setAttribute('typing-effect', String(enabled));\n    this.setAttribute('typing-speed', String(speed));\n  }\n\n  /**\n   * Enable or disable readonly mode.\n   * When readonly, the input line is hidden and users cannot type commands.\n   * Useful for presentation or demonstration purposes.\n   *\n   * @method setReadonly\n   * @param {boolean} readonly - Whether to enable readonly mode\n   * @returns {void}\n   * @example\n   * terminal.setReadonly(true);  // Disable input\n   * terminal.setReadonly(false); // Enable input\n   */\n  setReadonly(readonly) {\n    this.config.readonly = readonly;\n    this.setAttribute('readonly', String(readonly));\n    this._updateReadonlyState();\n  }\n\n  /**\n   * Override the user's `prefers-reduced-motion` system preference.\n   * When forced, typing animations will run even if the user has reduced motion enabled.\n   * Use sparingly and only for testing or when the animation is essential to the experience.\n   *\n   * @method setForceAnimations\n   * @param {boolean} force - If true, animations will run regardless of system preference\n   * @returns {void}\n   * @example\n   * terminal.setForceAnimations(true);  // Force animations on\n   * terminal.setForceAnimations(false); // Respect system preference\n   */\n  setForceAnimations(force) {\n    this.config.forceAnimations = force;\n    this.setAttribute('force-animations', String(force));\n  }\n\n  /**\n   * Check if the user has enabled `prefers-reduced-motion` in their system settings.\n   * When true, the terminal will skip typing animations unless `force-animations` is set.\n   *\n   * @method hasReducedMotion\n   * @returns {boolean} True if the user prefers reduced motion\n   * @example\n   * if (terminal.hasReducedMotion()) {\n   *   console.log('User prefers reduced motion');\n   * }\n   */\n  hasReducedMotion() {\n    return window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;\n  }\n\n  /**\n   * Set internationalization (i18n) strings for localization.\n   * Merges the provided strings with the existing defaults.\n   * Triggers a re-render to apply the new strings.\n   *\n   * @method setI18n\n   * @param {Object} strings - Object containing string keys to override\n   * @param {string} [strings.copy] - \"Copy\" button text\n   * @param {string} [strings.close] - \"Close\" button tooltip\n   * @param {string} [strings.minimize] - \"Minimize\" button tooltip\n   * @param {string} [strings.maximize] - \"Maximize\" button tooltip\n   * @param {string} [strings.toggleTheme] - \"Toggle theme\" button tooltip\n   * @param {string} [strings.copyAll] - \"Copy All\" menu item\n   * @param {string} [strings.copyCommandsOnly] - \"Copy Commands Only\" menu item\n   * @param {string} [strings.copyOutputOnly] - \"Copy Output Only\" menu item\n   * @param {string} [strings.copied] - \"Copied!\" feedback message\n   * @param {string} [strings.commandNotFound] - \"Command not found\" error message\n   * @returns {void}\n   * @example\n   * terminal.setI18n({\n   *   copy: 'Copiar',\n   *   copied: 'Copiado!',\n   *   commandNotFound: 'Comando no encontrado'\n   * });\n   */\n  setI18n(strings) {\n    if (strings && typeof strings === 'object') {\n      this._i18n = { ...this._i18n, ...strings };\n      // Re-render to apply new strings\n      this.render();\n      this._setupEventListeners();\n      this._applyAttributes();\n    }\n  }\n\n  /**\n   * Get a copy of the current i18n strings configuration.\n   *\n   * @method getI18n\n   * @returns {Object} Current i18n configuration object\n   * @example\n   * const strings = terminal.getI18n();\n   * console.log(strings.copy); // \"Copy\"\n   */\n  getI18n() {\n    return { ...this._i18n };\n  }\n\n  /**\n   * Get a localized string\n   * @param {string} key - The i18n key\n   * @returns {string} The localized string\n   */\n  _t(key) {\n    return this._i18n[key] || key;\n  }\n\n  /**\n   * Get the command history array.\n   * Returns a copy of the history, not a reference to the internal array.\n   *\n   * @method getHistory\n   * @returns {string[]} Array of previously executed commands (newest last)\n   * @example\n   * const history = terminal.getHistory();\n   * console.log(history); // ['ls', 'cd /home', 'cat file.txt']\n   */\n  getHistory() {\n    return this.historyManager.getHistory();\n  }\n\n  /**\n   * Replace the command history with a new array.\n   * Useful for restoring history from storage or initializing with predefined commands.\n   *\n   * @method setHistory\n   * @param {string[]} history - Array of commands to set as history\n   * @returns {void}\n   * @example\n   * terminal.setHistory(['ls', 'pwd', 'whoami']);\n   */\n  setHistory(history) {\n    this.historyManager.setHistory(history);\n  }\n\n  /**\n   * Clear all command history.\n   * If `persist-history` is enabled, also clears the localStorage entry.\n   *\n   * @method clearHistory\n   * @returns {void}\n   * @example\n   * terminal.clearHistory();\n   */\n  clearHistory() {\n    this.historyManager.clear();\n  }\n\n  /**\n   * Get all terminal output as plain text.\n   * Includes both commands (with prompts) and output lines.\n   *\n   * @method getContent\n   * @returns {string} All terminal content as newline-separated text\n   * @example\n   * const content = terminal.getContent();\n   * console.log(content);\n   * // $ ls\n   * // file1.txt file2.txt\n   * // $ pwd\n   * // /home/user\n   */\n  getContent() {\n    return this.outputLines.map(line => {\n      if (line.type === 'command') {\n        return `${line.prompt}${line.content}`;\n      }\n      return line.content;\n    }).join('\\n');\n  }\n\n  /**\n   * Focus the terminal's input field.\n   * Useful after programmatically interacting with the terminal.\n   *\n   * @method focus\n   * @returns {void}\n   * @example\n   * terminal.focus();\n   */\n  focus() {\n    this._focusInput();\n  }\n\n  /**\n   * Render the component\n   */\n  render() {\n    this.shadowRoot.innerHTML = `\n      <div class=\"terminal\"\n           data-theme=\"${this.config.theme}\"\n           data-cursor-style=\"${this.config.cursorStyle}\"\n           data-cursor-blink=\"${this.config.cursorBlink}\"\n           data-readonly=\"${this.config.readonly}\"\n           role=\"application\"\n           aria-label=\"Terminal emulator\">\n\n        <!-- Screen reader announcements -->\n        <div class=\"sr-announcer\" role=\"status\" aria-live=\"polite\" aria-atomic=\"true\"></div>\n\n        <div class=\"terminal-header\" style=\"${this.config.showHeader ? '' : 'display: none'}\">\n          <div class=\"window-controls\" style=\"${this.config.showControls ? '' : 'display: none'}\">\n            <button class=\"control close\" title=\"${this._t('close')}\" aria-label=\"${this._t('close')} terminal\"></button>\n            <button class=\"control minimize\" title=\"${this._t('minimize')}\" aria-label=\"${this._t('minimize')} terminal\"></button>\n            <button class=\"control maximize\" title=\"${this._t('maximize')}\" aria-label=\"${this._t('toggleFullscreen')}\" aria-pressed=\"false\"></button>\n          </div>\n          <div class=\"terminal-title\">\n            <slot name=\"title\">${this._escapeHtml(this.config.title)}</slot>\n          </div>\n          <div class=\"terminal-actions\">\n            <slot name=\"actions\"></slot>\n            <button class=\"theme-btn\"\n                    title=\"${this._t('toggleTheme')} (${this.config.theme === 'dark' ? this._t('switchToLight') : this._t('switchToDark')})\"\n                    aria-label=\"${this._t('toggleTheme')}\"\n                    style=\"${this.config.showThemeToggle ? '' : 'display: none'}\">\n              <span class=\"theme-icon\"></span>\n            </button>\n            <div class=\"copy-wrapper\" style=\"${this.config.showCopy ? '' : 'display: none'}\">\n              <button class=\"copy-btn\"\n                      title=\"${this._t('copy')} (right-click for options)\"\n                      aria-label=\"${this._t('copy')} terminal content\"\n                      aria-haspopup=\"menu\"\n                      aria-expanded=\"false\">${this._t('copy')}</button>\n              <div class=\"copy-menu\" role=\"menu\" aria-label=\"${this._t('copyOptions')}\">\n                <button class=\"copy-menu-item\" data-copy-mode=\"all\" role=\"menuitem\" tabindex=\"-1\">${this._t('copyAll')}</button>\n                <button class=\"copy-menu-item\" data-copy-mode=\"commands\" role=\"menuitem\" tabindex=\"-1\">${this._t('copyCommandsOnly')}</button>\n                <button class=\"copy-menu-item\" data-copy-mode=\"output\" role=\"menuitem\" tabindex=\"-1\">${this._t('copyOutputOnly')}</button>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div class=\"terminal-body\" role=\"log\" aria-live=\"polite\" aria-relevant=\"additions\">\n          <slot name=\"before-output\"></slot>\n          <div class=\"output\" role=\"list\" aria-label=\"${this._t('terminalOutput')}\"></div>\n          <div class=\"input-line\" style=\"${this.config.readonly ? 'display: none' : ''}\">\n            <span class=\"input-prompt\" aria-hidden=\"true\">${this._escapeHtml(this.config.prompt)}</span>\n            <span class=\"input-display\">\n              <span class=\"input-text\"></span>\n              <span class=\"cursor\" aria-hidden=\"true\"></span>\n            </span>\n            <input type=\"text\"\n                   class=\"hidden-input\"\n                   autocomplete=\"off\"\n                   autocorrect=\"off\"\n                   autocapitalize=\"off\"\n                   spellcheck=\"false\"\n                   aria-label=\"${this._t('terminalInputLabel')}\"\n                   role=\"textbox\" />\n          </div>\n        </div>\n      </div>\n    `;\n  }\n}\n\n// Register the custom element\nif (!customElements.get('terminal-window')) {\n  customElements.define('terminal-window', TerminalWindow);\n}\n\nexport default TerminalWindow;"],"names":["AnsiParser","text","escapeHtml","ansiRegex","result","lastIndex","currentClasses","match","textBefore","codes","code","c","remaining","CommandRegistry","name","handler","alias","command","input","firstWord","parts","current","inQuote","quoteChar","i","char","HistoryManager","direction","newIndex","history","cmd","enabled","e","saved","VirtualFileSystem","path","target","parentPath","dirName","parent","newDir","fileName","content","file","recursive","p","part","node","styles","TerminalWindow","sheet","welcome","oldValue","newValue","attr","value","terminal","promptEl","header","titleEl","controls","copyWrapper","themeBtn","inputLine","args","item","error","a","cmds","addToHistory","trimmed","resolved","cmdName","errorMessage","commands","defaultDelay","delay","line","type","lines","lineText","resolve","outputContainer","inputCursor","typingCursor","currentIndex","lineEl","rawText","ms","div","message","announcer","terminalBody","selection","copyBtn","copyMenu","mode","closeBtn","minimizeBtn","maximizeBtn","cmdPart","matches","inputText","masked","announcement","textarea","menu","items","originalText","theme","prompt","style","blink","speed","readonly","force","strings","key"],"mappings":"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AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;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"}